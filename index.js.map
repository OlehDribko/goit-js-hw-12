{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = \"48279024-d4145a4c2f3735ee57c61073f\"; \nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function fetchImages(query, page, perPage = 15) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page,\n        per_page: perPage,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error(\"Помилка при отриманні зображень:\", error);\n    throw error;\n  }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\n\n\nexport function createMarkup(images) {\n  return images\n    .map(({ tags, webformatURL, likes, comments, views, downloads, largeImageURL }) => {\n      return `\n      <li class=\"card\">\n        <a href=\"${largeImageURL}\" class=\"gallery-item\">\n          <img class=\"card-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"card-body\">\n          <ul class=\"card-value-list\">\n            <li class=\"card-value\"><h3>Likes</h3><p>${likes}</p></li>\n            <li class=\"card-value\"><h3>Views</h3><p>${views}</p></li>\n            <li class=\"card-value\"><h3>Comments</h3><p>${comments}</p></li>\n            <li class=\"card-value\"><h3>Downloads</h3><p>${downloads}</p></li>\n          </ul>\n        </div>\n      </li>`;\n    })\n    .join(\"\");\n}\n\nexport function updateGallery(container, markup, append = false) {\n  if (!markup.trim()) {\n    iziToast.warning({\n      title: \"Увага!\",\n      message: \"Нічого не знайдено. Спробуйте інший запит.\",\n      position: \"topRight\",\n      timeout: 3000,\n    });\n    return;\n  }\n\n  if (append) {\n    container.insertAdjacentHTML(\"beforeend\", markup);\n  } else {\n    container.innerHTML = markup;\n  }\n}\n\nexport function toggleLoadMoreBtn(button, show) {\n  button.style.display = show ? \"block\" : \"none\";\n}\n\nexport function scrollToNextPage() {\n  const cardHeight = document.querySelector(\".card\")?.getBoundingClientRect().height || 0;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: \"smooth\",\n  });\n}\n\nexport function showEndMessage() {\n   iziToast.info({\n    title: \"Вибірка завершена\",\n    message: \"Ви досягли кінця результатів пошуку.\",\n    position: \"topRight\",\n    timeout: 4000,\n  });\n}\n\nexport function refreshLightbox() {\n  const lightbox = new SimpleLightbox(\".gallery-item\", { captionsData: \"alt\", captionDelay: 250 });\n  lightbox.refresh();\n}\nexport const showLoader = () => {\n  const loader = document.querySelector(\".loader\");\n  if (loader) loader.style.display = \"block\";\n};\n\nexport const hideLoader = () => {\n  const loader = document.querySelector(\".loader\");\n  if (loader) loader.style.display = \"none\";\n};","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { fetchImages } from \"./js/pixabay-api.js\";\nimport {\n  createMarkup,\n  updateGallery,\n  toggleLoadMoreBtn,\n  scrollToNextPage,\n  showEndMessage,\n  refreshLightbox,\n  showLoader,\n  hideLoader,\n} from \"./js/render-functions.js\";\n\nconst form = document.querySelector(\".searchForm\");\nconst postsList = document.querySelector(\".card-list\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\n\nlet query = \"\";\nlet page = 1;\nconst perPage = 15;\nlet totalHits = 0;\nlet maxPage = 1;\nlet isLastPage = false;\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  query = event.target.querySelector(\"input\").value.trim();\n  if (!query) {\n    iziToast.error({\n      title: \"Помилка введення даних!\",\n      message: \"Введіть значення у форму для пошуку зображень.\",\n      backgroundColor: \"red\",\n      position: \"topRight\",\n      timeout: 3000,\n    });\n    return;\n  }\n\n  page = 1;\n  totalHits = 0;\n  isLastPage = false;\n  loadMoreBtn.style.display = \"none\";\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page, perPage);\n    totalHits = data.totalHits;\n    maxPage = Math.ceil(totalHits / perPage);\n\n    \n    if (data.hits.length === 0 && page === 1) {\n      iziToast.warning({\n        title: \"Нічого не знайдено!\",\n        message: \"Спробуйте змінити параметри пошуку.\",\n        position: \"topRight\",\n        timeout: 3000,\n      });\n      return updateGallery(postsList, \"\");\n    }\n\n    updateGallery(postsList, createMarkup(data.hits));\n    refreshLightbox();\n\n\n    if (page >= maxPage) {\n      isLastPage = true;\n      toggleLoadMoreBtn(loadMoreBtn, false);\n      showEndMessage();\n      return; \n    }\n\n    toggleLoadMoreBtn(loadMoreBtn, true);\n  } catch (error) {\n    iziToast.error({\n      title: \"Помилка сервера!\",\n      message: \"Змініть параметри пошуку.\",\n      position: \"topRight\",\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener(\"click\", async () => {\n  if (isLastPage) {\n    toggleLoadMoreBtn(loadMoreBtn, false);\n    return;\n  }\n\n  page++;\n  showLoader();\n  toggleLoadMoreBtn(loadMoreBtn, false);\n\n  try {\n    const data = await fetchImages(query, page, perPage);\n\n    if (data.hits.length === 0 || page >= maxPage) {\n      isLastPage = true;\n      toggleLoadMoreBtn(loadMoreBtn, false);\n      showEndMessage();\n      return;\n    }\n\n    updateGallery(postsList, createMarkup(data.hits), true);\n    refreshLightbox();\n    scrollToNextPage();\n\n    if (data.hits.length < perPage || page >= maxPage) {\n      isLastPage = true;\n      toggleLoadMoreBtn(loadMoreBtn, false);\n      showEndMessage();\n    } else {\n      toggleLoadMoreBtn(loadMoreBtn, true);\n    }\n  } catch (error) {\n    iziToast.error({\n      title: \"Перелік вичерпано\",\n      message: \"Не вдалося отримати додаткові результати.\",\n      position: \"topRight\",\n      timeout: 3000,\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","perPage","axios","error","createMarkup","images","tags","webformatURL","likes","comments","views","downloads","largeImageURL","updateGallery","container","markup","append","iziToast","toggleLoadMoreBtn","button","show","scrollToNextPage","cardHeight","_a","showEndMessage","refreshLightbox","SimpleLightbox","showLoader","loader","hideLoader","form","postsList","loadMoreBtn","totalHits","maxPage","isLastPage","event","data"],"mappings":"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"}